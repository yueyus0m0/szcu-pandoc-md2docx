# 🛠️ 环境下载与安装指南

> **前言**：本项目依赖两个核心工具：**Pandoc**（文档转换引擎）和 **Pandoc-Crossref**（图表交叉引用插件）。
> 
> ⚠️ **请务必严格按照以下版本下载，版本不匹配将导致转换失败！**

---

## 📦 第一步：安装 Pandoc (v3.8.2.1)

### 1. 下载安装包
* **下载地址**：[Pandoc 3.8.2.1 Release 页面](https://github.com/jgm/pandoc/releases/tag/3.8.2.1)
* **操作**：在页面下方找到 `Assets` 区域，点击下载 **`pandoc-3.8.2.1-windows-x86_64.msi`**。
![[Pasted image 20251209201705.png]]
### 2. 执行安装
1.  双击下载好的 `.msi` 文件。
2.  一路点击 **Next**（下一步）。
3.  **关键步骤**：在安装选项页，务必勾选 **"Install for all users"**（如果可选）或确保勾选 **"Add to PATH"**（添加到系统环境变量）。
    > *如果不勾选此项，后续命令将无法运行！*

### 3. 验证安装
按下键盘 `Win + R`，输入 `cmd` 并回车，在黑色窗口中输入：

```bash
pandoc -v
````

如果出现类似下面的版本信息，说明安装成功：

> pandoc 3.8.2.1
> Features: +server +lua +pandoc-json ...
-----

## 🧩 第二步：安装 Pandoc-Crossref (插件)

> **注意**：这不是一个安装包，而是一个需要**手动解压**的插件。

### 1\. 下载插件

  * **下载地址**：[Pandoc-Crossref Release 页面](https://github.com/lierdakil/pandoc-crossref/releases)
  * **操作**：
    1.  找到与 **Pandoc v3.8.2.1** 对应的版本（通常 Release 标题会写明 `v0.x.x.x for pandoc 3.8.2.1`）。
    2.  下载 **`pandoc-crossref-Windows.7z`**（注意不要下载成 source code）。
![[Pasted image 20251209202229.png]]
### 2\. 解压并安装

此步骤容易出错，请仔细操作：

1.  解压下载的 `.7z` 压缩包（你需要安装 7-Zip 或 WinRAR）。
2.  解压后，你会得到一个名为 `pandoc-crossref.exe` 的文件。
3.  **寻找 Pandoc 安装目录**：
      * 通常在：`C:\Program Files\Pandoc\`
      * 或者：`C:\Users\你的用户名\AppData\Local\Pandoc\`
      * *小技巧*：在刚才的 cmd 窗口输入 `where pandoc` 可以查看安装路径。
4.  **拖入文件**：将解压出来的 `pandoc-crossref.exe` **复制/移动** 到 Pandoc 的安装目录中（即和 `pandoc.exe` 放在一起）。

![[Pasted image 20251209202710.png]]

-----

## 

## 🐍 第三步：安装 Python 依赖库 (python-docx)

> **说明**：为了完美解决 Word 的页眉继承和页码重置问题，本项目引入了 `scripts/fix_word_layout.py` 脚本，该脚本依赖 `python-docx` 库。

### 1. 确认 Python 环境

在 cmd 窗口中输入 `python --version`。

* 若显示版本号（如 `Python 3.10.x`），请继续下一步。
* **若提示错误**：请前往 [Python 官网](https://www.python.org/downloads/) 下载安装（安装时**务必勾选 "Add Python to PATH"**）。

### 2. 安装 python-docx

在 cmd 窗口中执行以下命令：

```bash
pip install python-docx

```

### 3. 验证安装

输入以下命令，若无报错并输出 "Success"，则表示安装成功：

```bash
python -c "import docx; print('Success')"

```

---

## ✅ 最终验证

再次打开 cmd 窗口，依次检查三个工具：

1. **Pandoc**:
```bash
pandoc -v

```


2. **Crossref**:
```bash
pandoc-crossref --version

```


3. **Python Lib**:
```bash
python -c "import docx; print('docx is ready')"

```



如果全部通过，恭喜你！环境配置已全部完成。

你可以返回主目录，直接双击 **`build.bat`** 即可一键生成论文，或参照 `README.md` 查看详细指令。

